import{a as b,b as h,c as j,d as x,j as e,r as u,e as w}from"./index-C-Bs6Dn2.js";import{u as p,a as y,o as f,s as g}from"./schemas-DVjx1ahK.js";const v=async()=>{const{data:t}=await x.get("/note");return console.log("data",t),t.notes},S=()=>j({queryKey:["notes"],queryFn:v}),C=async t=>{const{data:s}=await x.post("/note",t);return s},k=()=>{const t=b();return h({mutationFn:C,onSuccess:()=>{t.invalidateQueries({queryKey:["notes"]})}})},q=async t=>{await x.delete(`/note/${t}`)},E=()=>{const t=b();return h({mutationFn:q,onSuccess:()=>{t.invalidateQueries({queryKey:["notes"]})}})},z=async({noteId:t,data:s})=>(await x.patch(`/note/${t}`,s)).data,F=()=>{const t=b();return h({mutationFn:z,onSuccess:()=>{t.invalidateQueries({queryKey:["notes"]})}})},L=async t=>{const{data:s}=await x.get(`/note/${t}/summarize`);return console.log("data",s),s},P=()=>h({mutationFn:L}),Q=({note:t,onEdit:s,onSummarize:r})=>{const{mutate:n,isPending:a}=E(),o=()=>{window.confirm("Are you sure you want to delete this note?")&&n(t.note_id)};return e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border border-gray-200",children:[e.jsx("h3",{className:"text-xl font-bold mb-2",children:t.title}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.content}),e.jsxs("div",{className:"mt-4 flex gap-2 w-full justify-between",children:[e.jsxs("div",{className:"flex flex-row justify-between gap-2",children:[e.jsx("button",{onClick:o,disabled:a,className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-white bg-red-600 rounded hover:bg-red-700",children:a?"Deleting...":"Delete"}),e.jsx("button",{onClick:()=>s(t),className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-700",children:"Edit"})]}),e.jsx("button",{onClick:()=>r(t),className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-black bg-amber-200 rounded hover:bg-amber-700",children:"Summarize"})]})]})},A=({onEditNote:t,onSummarize:s})=>{const{data:r,isLoading:n,isError:a,error:o}=S(),[i,c]=u.useState(""),d=u.useMemo(()=>{if(!r)return[];const l=i.trim().toLowerCase();return l?r.filter(m=>(m.title||"").toLowerCase().includes(l)):r},[r,i]);return n?e.jsx("p",{children:"Loading notes..."}):a?e.jsxs("p",{children:["Error fetching notes: ",o.message]}):e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{children:e.jsx("input",{className:"w-full bg-amber-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5",placeholder:"Search for title",value:i,onChange:l=>c(l.target.value)})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[d.map(l=>e.jsx(Q,{note:l,onEdit:t,onSummarize:s},l.id)),d.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No notes match your search."})]})]})},D=f({title:g().min(1,"Title is required"),content:g().min(1,"content is required")}),M=()=>{const{register:t,handleSubmit:s,reset:r,formState:{errors:n}}=p({resolver:y(D)}),{mutate:a,isPending:o}=k(),i=c=>{a(c,{onSuccess:()=>{console.log("mutation success"),r()},onError:d=>console.error("mutation error",d)})};return e.jsxs("form",{onSubmit:s(i),className:"mb-8 p-4 bg-gray-100 rounded-lg",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Add a New Note"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"title"}),e.jsx("input",{...t("title",{required:!0}),id:"title",type:"text",placeholder:"Title",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),n.title&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:n.title.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700",children:"content"}),e.jsx("textarea",{...t("content"),placeholder:"Content...",id:"content",rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),n.title&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:n.title.message})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:o,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-indigo-300",children:o?"Saving...":"Add Note"})})]})]})},K=({isOpen:t,onClose:s,children:r})=>(u.useEffect(()=>{document.body.style.overflow=t?"hidden":"unset"},[t]),t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:s,children:e.jsxs("div",{className:"relative w-full max-w-lg p-6 bg-white rounded-lg shadow-xl",onClick:n=>n.stopPropagation(),children:[r,e.jsx("button",{onClick:s,className:"absolute top-2 right-2 px-2 py-1 text-lg text-gray-500 hover:text-gray-800",children:"Ã—"})]})}):null),G=({noteToEdit:t,onClose:s})=>{const r=f({title:g().min(1,"Title is required"),content:g().min(1,"content is required")}),{register:n,handleSubmit:a,reset:o,formState:{errors:i}}=p({resolver:y(r),defaultValues:{title:t?.title||"",content:t?.content||""}}),{mutate:c,isPending:d}=F();u.useEffect(()=>{t&&o({title:t.title,content:t.content})},[t,o]);const l=m=>{c({noteId:t.note_id,data:m},{onSuccess:()=>{s()}})};return e.jsxs("form",{onSubmit:a(l),className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Edit Note"}),e.jsxs("div",{children:[e.jsx("input",{...n("title"),placeholder:"Title",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),i.title&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.title.message})]}),e.jsxs("div",{children:[e.jsx("textarea",{...n("content"),placeholder:"Content...",rows:"6",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),i.content&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.content.message})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-indigo-300",children:d?"Saving...":"Save Changes"})]})]})},_=({isOpen:t,onClose:s,noteToSummarize:r})=>{const{mutate:n,data:a,isPending:o,isSuccess:i,isError:c,error:d,reset:l}=P();u.useEffect(()=>{document.body.style.overflow=t?"hidden":"unset",t||l()},[t,l]);const m=()=>{r&&n(r.note_id)};return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:s,children:e.jsxs("div",{className:"relative w-full max-w-2xl p-6 bg-white rounded-lg shadow-xl",onClick:N=>N.stopPropagation(),children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"AI-Powered Summary"}),e.jsxs("div",{className:"p-4 border rounded-md bg-gray-50 min-h-[200px]",children:[!o&&!i&&!c&&e.jsxs("div",{className:"text-center flex flex-col items-center justify-center h-full",children:[e.jsx("p",{className:"mb-4",children:"Click the button to generate a summary for this note."}),e.jsx("button",{onClick:m,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Generate Summary"})]}),o&&e.jsx("p",{children:"ðŸ§  Generating summary, please wait..."}),i&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Summary:"}),e.jsx("p",{className:"whitespace-pre-wrap",children:a.summary})]}),c&&e.jsxs("p",{className:"text-red-600",children:["Error: ",d.message]})]}),e.jsx("button",{onClick:s,className:"absolute top-2 right-2 px-2 py-1 text-lg text-gray-500 hover:text-gray-800",children:"Ã—"})]})}):null},R=()=>{const[t,s]=u.useState(null),[r,n]=u.useState(null),{mutate:a,isPending:o}=w(),i=()=>{window.confirm("Are you sure you want to log out?")&&a()};return e.jsxs("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8",children:[e.jsxs("div",{className:"flex flex-row justify-between ",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"My Notes"}),e.jsx("button",{onClick:i,disabled:o,className:"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 h-[30%] flex",children:o?"Logging out...":"Log out"})]}),e.jsx(M,{})," ",e.jsx(A,{onEditNote:s,onSummarize:n})," ",e.jsx(K,{isOpen:!!t,onClose:()=>s(null),children:e.jsx(G,{noteToEdit:t,onClose:()=>s(null)})}),e.jsx(_,{noteToSummarize:r,isOpen:!!r,onClose:()=>n(null)})]})};export{R as default};
